{% extends 'base.html' %}
{% block content %}

<h2>ðŸ§  {{ quiz.title }}</h2>

<hr>

<!-- =========================
     ADD QUESTION (MANUAL)
========================= -->
<div class="card mb-4">
    <div class="card-body">
        <h5>Add Question (Manual)</h5>

        <form method="post">
            {% csrf_token %}

            <div class="mb-3">
                <label class="form-label">Question</label>
                <input type="text" name="question" class="form-control" required>
            </div>

            <div class="mb-3">
                <label class="form-label">Option 1</label>
                <input type="text" name="option1" class="form-control" required>
            </div>

            <div class="mb-3">
                <label class="form-label">Option 2</label>
                <input type="text" name="option2" class="form-control" required>
            </div>

            <div class="mb-3">
                <label class="form-label">Correct Option</label>
                <select name="correct" class="form-select" required>
                    <option value="1">Option 1</option>
                    <option value="2">Option 2</option>
                </select>
            </div>

            <button class="btn btn-success">
                âž• Add Question
            </button>
        </form>
    </div>
</div>

<!-- =========================
     BULK UPLOAD
========================= -->
<div class="card mb-4">
    <div class="card-body">
        <h5>ðŸ“‚ Bulk Upload Questions</h5>

        <a href="{% url 'download_quiz_template' quiz.id %}"
           class="btn btn-outline-primary mb-3">
            â¬‡ Download CSV Template
        </a>

        <form method="post"
              action="{% url 'bulk_upload_questions' quiz.id %}"
              enctype="multipart/form-data">
            {% csrf_token %}

            <div class="mb-3">
                <input type="file" name="file" accept=".csv" required>
            </div>

            <button class="btn btn-outline-success">
                â¬† Upload CSV
            </button>
        </form>
    </div>
</div>

<!-- =========================
     EXISTING QUESTIONS
========================= -->
<div class="card">
    <div class="card-body">
        <h5>ðŸ“‹ Existing Questions</h5>

        {% if quiz.questions.all %}
            <ol>
            {% for q in quiz.questions.all %}
                <li class="mb-2">
                    {{ q.text }}
                    <ul>
                        {% for opt in q.options.all %}
                        <li>
                            {{ opt.text }}
                            {% if opt.is_correct %}
                                <strong>(âœ”)</strong>
                            {% endif %}
                        </li>
                        {% endfor %}
                    </ul>
                </li>
            {% endfor %}
            </ol>
        {% else %}
            <p class="text-muted">No questions added yet.</p>
        {% endif %}
    </div>
</div>

<a href="{% url 'course_detail' quiz.lesson.course.id %}"
   class="btn btn-secondary mt-4">
    â¬… Back to Course
</a>

{% endblock %}
